{% extends "timesheets/base.html" %}
{% block title %}View Site Employees - Espanini{% endblock %}

{% block content %}
<style>
  a:hover {
    background-color: #eaeef8;
    border-radius: 8px;
    box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    padding: 5px;
    text-decoration: none;
  }

  .card {
    box-shadow: 0 4px 8px rgba(0, 0, 0, 1);
    border: none;
    transition: all 0.3s ease;
    border-radius: 10px;
  }

  .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
  }

  @media (max-width: 992px) {
    .card {
      margin: 10px;
    }
  }

  /* Search bar alignment + spacing */
  .search-bar {
    width: 250px;
  }
</style>

<body>
  <!-- 🔍 Search Bar Row -->
  <div class="container mt-4">
    <div class="row mb-3">
      <div class="d-flex justify-content-end">
        <div class="search-bar">
          <input type="text" id="searchInput" class="form-control" placeholder="Search for employees...">
        </div>
      </div>
    </div>
  </div>

  <section style="padding: 60px;">
    <div class="tittle wow fadeInUp text-center" style="visibility: visible; animation-name: fadeInUp;">
      <h4 class="display-6">Select {{ site }} Employee</h4>
      <p>{{ today }}</p>
    </div>
  </section>

  <div class="container text-center">
    <!-- 👇 Employee Grid -->
    <div class="row justify-content-center" id="employeeList">
      {% for employee in employees %}
      <div class="col-md-4 col-sm-6 mb-4 employee-card">
        <a href="{% url 'view_employee_timesheets' employee.id site.site_id %}" class="text-decoration-none text-black">
          <div class="card" style="background: #f9fafa; position: relative;">
            <div class="card-body">
              <h5 class="card-title">{{ employee.first_name }} {{ employee.last_name }}</h5>
              <p class="card-text mb-1">Employee No: {{ employee.employee_id }}</p>
            </div>
            {% if employee.count > 0 %}
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
              {{ employee.count }}
            </span>
            {% endif %}
          </div>
        </a>
      </div>
      {% endfor %}
    </div>
  </div>

  <script>
    // 🔍 Client-side search for employee cards
    document.addEventListener("DOMContentLoaded", function() {
      const searchInput = document.getElementById('searchInput');
      const employeeCards = document.querySelectorAll('.employee-card');

      searchInput.addEventListener('keyup', function() {
        const filter = searchInput.value.toLowerCase();
        employeeCards.forEach(card => {
          const text = card.textContent.toLowerCase();
          card.style.display = text.includes(filter) ? '' : 'none';
        });
      });
    });
  </script>
</body>
{% endblock %}
