{% extends "timesheets/base.html" %}
{% block title %}Employees - Espanini{% endblock %}

{% block content %}

<div class="container-fluid">
  <div class="row mb-3">
    <div class="d-flex justify-content-between align-items-center w-100">
      <h1 class="display-6">Employees</h1>
      <div class="search-bar">
        <input type="text" id="searchInput" class="form-control" placeholder="Search for employees...">
      </div>
    </div>
  </div>

  <a href="{% url 'add_employee' %}" class="btn btn-sm btn-outline-primary float-end mb-3">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
         class="bi bi-plus" viewBox="0 0 16 16">
      <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
    </svg>
  </a>

  <form method="get" action="{% url 'employees' %}" class="mb-3">
    <label for="site">Site:</label>
    <select id="site" name="site" onchange="this.form.submit()">
      <option value="">All</option>
      {% for site in sites %}
      <option value="{{ site.site_id }}" {% if selected_site == site.site_id|stringformat:"s" %}selected{% endif %}>
        {{ site }}
      </option>
      {% endfor %}
    </select>
  </form>






  <div class="limiter">
		<div class="container-table100">
			<div class="wrap-table100">
				<div class="table100 ver1 m-b-110">
					<div class="table100-head">
						<table>
							<thead>
								<tr class="row100 head">
									<th class="cell100 column1">Employee No.</th>
									<th class="cell100 column2">First Name</th>
									<th class="cell100 column3">Last Name</th>
									<th class="cell100 column4">Site</th>
									<th class="cell100 column5">Connected</th>
                                    <th class="cell100 column6"></th>

								</tr>
							</thead>
						</table>
					</div>

					<div class="table100-body js-pscroll ps ps--active-y">
						<table>
							<tbody>
                             {% for employee in employees %}













                                <tr class="row100 body">
                                    <td class="cell100 column1">
                                    <a href="{% url 'view_employee' employee.id %}" class="text-decoration-none text-black">
									{{ employee.employee_id }}
                                        </a></td>
									<td class="cell100 column2">{{ employee.first_name }}</td>
									<td class="cell100 column3">{{ employee.last_name }}</td>

                                    <td class="cell100 column4">
          {% if employee.site == "Unknown" %}
            <span class="text-danger">{{ employee.site }}</span>
          {% else %}
            {{ employee.site }}
          {% endif %}
        </td>

                                          <td class="cell100 column5">
          {% if employee.connected %}
            <span class="text-success">üü¢</span>
          {% else %}
            <span class="text-danger">‚ùå</span>
          {% endif %}
        </td>
                                    <td class="cell100 column6">

          <a href="{% url 'edit_employee' employee.id %}" class="btn btn-sm btn-warning">Edit</a>
        </td>
								</tr>


								{% endfor %}
							</tbody>
						</table>
					<div class="ps__rail-x" style="left: 0px; bottom: -581px;"><div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div></div><div class="ps__rail-y" style="top: 581px; height: 585px; right: 5px;"><div class="ps__thumb-y" tabindex="0" style="top: 292px; height: 293px;"></div></div></div>
				</div>







                </tbody>
						</table>
					<div class="ps__rail-x" style="left: 0px; bottom: 0px;"><div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div></div><div class="ps__rail-y" style="top: 0px; height: 585px; right: 0px;"><div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 291px;"></div></div></div>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const searchInput = document.getElementById('searchInput');
  const employeeRows = document.querySelectorAll('tbody tr');

  searchInput.addEventListener('keyup', function() {
    const filter = searchInput.value.toLowerCase();
    employeeRows.forEach(row => {
      const rowText = row.textContent.toLowerCase();
      row.style.display = rowText.includes(filter) ? '' : 'none';
    });
  });
});
</script>
{% endblock %}
